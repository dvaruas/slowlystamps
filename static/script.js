(()=>{"use strict";class e{constructor(e){this.rarity=e}get id(){return"$rarity-{this.rarity}"}testValidity(e){return e.rarity===this.rarity}}class t{constructor(e){this.price=e}get id(){return`price-${this.price}`}testValidity(e){return e.price===this.price}}class n{constructor(e){this.country=e}get id(){var e;return`country-${null!==(e=this.country)&&void 0!==e?e:"NA"}`}testValidity(e){return e.country===this.country}}const l=["castle-","time-machine"],r="sw-stamp-",s="sw-modal",i=(e,t)=>e.replace(/{([0-9]+)}/g,(function(e,n){return void 0===t[n]?e:t[n]}));class a{constructor(e,t=null,n=(()=>{}),l=(()=>{})){var r;this.e=e;let s="border",i="border-bottom";e.classList.add("badge","rounded-pill","mx-1",null===(r=null==t?void 0:t())||void 0===r||r?s:i,"border-dark","sw-modal-badge"),e.onclick=()=>{null!=t&&(t()?(l(),e.classList.replace(s,i)):(n(),e.classList.replace(i,s)))}}get element(){return this.e}static createTypeBadge(e){let t=document.createElement("span");return t.classList.add("bg-primary"),t.innerHTML=`Type: ${e}`,new a(t)}static createRarityBadge(t,n){let l=document.createElement("span");l.classList.add("bg-warning","text-dark"),l.innerHTML=`Rarity: ${(e=>{switch(e){case"-1":return"L0";case"1":return"L1";case"2":return"L2";default:return"L3"}})(t)}`;let r=new e(t);return new a(l,(()=>n.hasFilter(r)),(()=>n.addFilter(r)),(()=>n.removeFilter(r)))}static createPriceBadge(e,n){let l=document.createElement("span");l.classList.add("bg-info","text-dark"),l.innerHTML=`Price: ${(e=>{switch(e){case"-1":case"0":return"free";case"1":return"premium";case"2":return"pricey";default:return"unknown"}})(e)}`;let r=new t(e);return new a(l,(()=>n.hasFilter(r)),(()=>n.addFilter(r)),(()=>n.removeFilter(r)))}static createCountryBadgeElement(e,t){let l=document.createElement("span");var r;l.classList.add("bg-info","text-dark","mx-1"),l.innerHTML=`Country: ${r=e,null===r?"NA":r}`;let s=new n(e);return new a(l,(()=>t.hasFilter(s)),(()=>t.addFilter(s)),(()=>t.removeFilter(s)))}}class d{constructor(e,t){this.title=e,this.e=t}static fromStampElement(e,t){let n=document.createElement("img");n.src=e.stampImagePath;let l=document.createElement("a");l.href=i("https://cdn.getslowly.com/assets/images/stamp/{0}.png",[e.slug]),l.target="_blank",l.appendChild(n);let r=document.createElement("div");r.classList.add("col-5","p-0"),r.appendChild(l);let s=document.createElement("p");s.innerHTML=`<b>Description: </b> ${e.description}`;let c=a.createTypeBadge(e.type),h=a.createRarityBadge(e.rarity,t),u=a.createPriceBadge(e.price,t),o=a.createCountryBadgeElement(e.country,t),m=document.createElement("div");m.classList.add("col-7","p-0"),m.appendChild(s),m.appendChild(c.element),m.appendChild(h.element),m.appendChild(u.element),m.appendChild(o.element);let p=document.createElement("div");p.classList.add("row"),p.appendChild(r),p.appendChild(m);let g=document.createElement("div");return g.classList.add("container"),g.appendChild(p),new d(e.name,g)}get titleString(){return this.title}get bodyElement(){return this.e}}class c{constructor(e,t,n,l,r,s,i,a,d){this.id=e,this.slug=t,this.name=n,this.type=l,this.rarity=r,this.price=s,this.description=i,this.country=a,this.stampImagePath=d,this.e=null}get element(){return null!=this.e||(this.e=document.createElement("div"),this.e.id=`${r}${this.id}`,this.e.classList.add("card","text-dark","sw-display-card"),this.e.innerHTML=i('\n<img class="card-img-top {0}" src="{1}" alt="{2}"> \n<div class="card-body text-center">\n    <span class="card-title {3}">{4}</span>\n</div>',["sw-card-img",this.stampImagePath,this.slug,"sw-card-text",this.name]),this.e.setAttribute("data-bs-toggle","modal"),this.e.setAttribute("data-bs-target",`#${s}`)),this.e}static fromJson(e,t){let n=e.id;if(null==n)return null;let r=e.slug;if(null==r)return null;if(l.includes(r))return null;let s=e.name;if(null==s)return null;let a=e.type;if(null==a)return null;let d=e.rarity;if(null==d)return null;let h=e.price;if(null==h)return null;let u=e.desc;if(null==u)return null;let o=e.country;return new c(n,r,s,a,d,h,u,o,i(t,[r]))}}class h{constructor(e,t,n,l){let r=document.createElement("li");r.classList.add("page-item","sw-page-number"),r.innerHTML=`<a class="page-link">${e}</a>`,r.onclick=()=>{t.innerHTML="",n.forEach((e=>{t.appendChild(e.element)})),l(this)},this.element=r}set active(e){e?this.element.classList.add("active"):this.element.classList.remove("active")}}class u{constructor(e,t){this.slotElements=e,this.parentElement=t,this.prevMarkerElement=null,this.nextMarkerElement=null,this.currStartIndx=0,this.numberOfActualSlots=e.length,e.length>u.slidingWindowLength&&(this.prevMarkerElement=document.createElement("li"),this.prevMarkerElement.classList.add("page-item"),this.prevMarkerElement.innerHTML='\n      <a class="page-link" href="#" aria-label="Previous">\n        <span aria-hidden="true">&laquo;</span>\n      </a>\n    ',this.nextMarkerElement=document.createElement("li"),this.nextMarkerElement.classList.add("page-item"),this.nextMarkerElement.innerHTML='\n      <a class="page-link" href="#" aria-label="Next">\n        <span aria-hidden="true">&raquo;</span>\n      </a>\n    ',this.numberOfActualSlots=u.slidingWindowLength-2),this.updatePaginationState()}updatePaginationState(){this.parentElement.innerHTML="",null!=this.prevMarkerElement&&(this.parentElement.appendChild(this.prevMarkerElement),0==this.currStartIndx?(this.prevMarkerElement.classList.add("disabled"),this.prevMarkerElement.onclick=null):(this.prevMarkerElement.classList.remove("disabled"),this.prevMarkerElement.onclick=()=>{this.currStartIndx-=this.numberOfActualSlots,this.currStartIndx<0&&(this.currStartIndx=0),this.updatePaginationState()}));for(let e=0;e<this.numberOfActualSlots;e++)this.parentElement.appendChild(this.slotElements[this.currStartIndx+e]);null!=this.nextMarkerElement&&(this.parentElement.appendChild(this.nextMarkerElement),this.currStartIndx+this.numberOfActualSlots==this.slotElements.length?(this.nextMarkerElement.classList.add("disabled"),this.nextMarkerElement.onclick=null):(this.nextMarkerElement.classList.remove("disabled"),this.nextMarkerElement.onclick=()=>{this.currStartIndx+=this.numberOfActualSlots,this.currStartIndx+this.numberOfActualSlots-1>=this.slotElements.length&&(this.currStartIndx=this.slotElements.length-this.numberOfActualSlots),this.updatePaginationState()}))}}u.slidingWindowLength=7;class o{constructor(e,t,n,l){this.stampsCountElement=t,this.displayArea=n,this.displayElements=l,this.filters=new Map,this.navigationBlockElement=document.createElement("ul"),this.navigationBlockElement.classList.add("pagination"),e.appendChild(this.navigationBlockElement),this.refresh()}refresh(){let e=[...this.displayElements];for(let[t,n]of this.filters)e=e.filter(n.testValidity,n);let t=Math.ceil(e.length/o.displayElementsPerPage),n=[],l=e=>{n.forEach((e=>e.active=!1)),e.active=!0};for(let r=0;r<t;r++){let t=o.displayElementsPerPage*r,s=t+o.displayElementsPerPage;s>=e.length&&(s=e.length),n.push(new h(r+1,this.displayArea,e.slice(t,s),l))}this.stampsCountElement.innerHTML=`#${e.length}`;let r=[];n.forEach((e=>r.push(e.element))),this.navigationBlockElement.innerHTML="",new u(r,this.navigationBlockElement),r[0].click()}addFilter(e){this.filters.has(e.id)||(this.filters.set(e.id,e),this.refresh())}removeFilter(e){this.filters.delete(e.id)&&this.refresh()}removeAllFilters(){this.filters.clear(),this.refresh()}hasFilter(e){return this.filters.has(e.id)}}o.displayElementsPerPage=100,document.addEventListener("DOMContentLoaded",(function(e){let t,n=document.getElementById("sw-container");if(null==n)return;let l=[],i=new Map,a=document.getElementById(s),h=document.getElementById("sw-modal-title"),u=document.getElementById("sw-modal-body");null!=a&&null!=h&&null!=u&&a.addEventListener("show.bs.modal",(e=>{let n=e.relatedTarget,l=i.get(n.id);if(null!=l){let e=d.fromStampElement(l,t);h.replaceChildren(e.titleString),u.replaceChildren(e.bodyElement)}})),fetch("./static/assets/slowly.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>e.json())).then((e=>{e.items.forEach((e=>{let t=c.fromJson(e,"./static/assets/{0}.webp");null!=t&&(l.push(t),i.set(`${r}${t.id}`,t))})),l.sort(((e,t)=>t.id-e.id));let s=document.getElementById("sw-count");if(null==s)return;let a=document.getElementById("sw-navbar");if(null==a)return;t=new o(a,s,n,l);let d=document.getElementById("sw-filter-clear");null!=d&&(d.onclick=()=>t.removeAllFilters())}))}))})();